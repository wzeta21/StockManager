@model StockManager.Data.Entities.Product
@{
    ViewData["Title"] = "Nuevo producto";
    var brands = (IEnumerable<StockManager.Data.Entities.Brand>)ViewData["brands"];
    var categories = (IEnumerable<StockManager.Data.Entities.Category>)ViewData["categories"];
}
<h2>@ViewData["Title"]</h2>

<form asp-action="Add">
    <div class="form-group row">
        <label for="name" class="col-sm-2 col-form-label">*Nombre del producto</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="name" asp-for="Name">
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-2">*Categoria</div>
        <div class="col-sm-10">
            <select asp-for="CategoryId" asp-items="@(new SelectList(@categories,"Id","Name"))" class="form-control"></select>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-2">*Marca</div>
        <div class="col-sm-10">
            <select asp-for="BrandId" asp-items="@(new SelectList(@brands,"Id","Name"))" class="form-control"></select>
        </div>
    </div>
    <div class="form-group row">
        <label for="description" class="col-sm-2 col-form-label">Descripción</label>
        <div class="col-sm-10">
            <textarea class="form-control" rows="3" id="description" asp-for="Description"></textarea>
        </div>
    </div>
    <div class="form-group row">
        <label for="tags" class="col-sm-2 col-form-label">*Tags</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="tags" asp-for="Tags">
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-2">Imagen</div>
        <div class="col-sm-10">
            <div class="row">
                <div class="col-sm-6">
                    <img id="picture" width="50%" height="50%" src="" asp-for="ImageUrl" />
                </div>
                <div class="col-sm-6">
                    <label class="input-group-btn">
                        <span class="btn btn-primary">
                            Subir foto
                            <input type="file" style="display: none;" name="selectPicture" id="selectPicture">
                        </span>
                    </label>
                </div>
            </div>

        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-12">
            <button type="submit" value="Add" class="btn btn-primary btn-block">Guardar</button>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-2">
            <a href="/Home/Index"> Volver </a>
        </div>
    </div>
</form>

@section Scripts{
    <script type="text/javascript">
        $(document).ready(() => {
            $(function () {
                $('#selectPicture').change((e) => {
                    addImage(e);
                });

                function addImage(e) {
                    var file = e.target.files[0],
                        imageType = /image.*/;

                    if (!file.type.match(imageType))
                        return;

                    var reader = new FileReader();
                    reader.onload = (e) => {
                        var result = e.target.result;
                        $('#picture').attr("src", result);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });
    </script>
}